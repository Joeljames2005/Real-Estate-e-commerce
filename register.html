<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register | Real Estate eCommerce</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>Real Estate eCommerce - Chennai, Tamil Nadu</h1>
    </header>

    <div class="container">
        <div class="register-box">
            <h2 style="margin:0;">Register</h2>
            
            <div class="form-group">
                <span style="display: flex; align-items: center;">
                    <label style="width: 120px;">Email</label>
                    <input style="flex: 1; margin-left: 20px;" type="email" id="email" placeholder="Email" required>
                </span>
            </div>
            
            <div class="form-group">
                <span style="display: flex; align-items: center;">
                    <label style="width: 120px;">Password</label>
                    <input style="flex: 1; margin-left: 20px;" type="password" id="password" placeholder="Password" required>
                </span>
            </div>
            
            <div class="form-group">
                <span style="display: flex; align-items: center;">
                    <label style="width: 120px;">Confirm Password</label>
                    <input style="flex: 1; margin-left: 20px;" type="password" id="confirmPassword" placeholder="Confirm Password" required>
                </span>
            </div>
            
            <button onclick="register()" class="button">Register</button>
            <p style="color: red;" id="register-message"></p>
            <p class="login-link">Already have an account? <a href="login.html">Login here</a></p>
        </div>
    </div>

    <!-- Firebase SDK and JavaScript -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.3.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/11.3.1/firebase-auth.js";
        import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/11.3.1/firebase-firestore.js";

        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCwe0qStrRKc-sY1X84OUSYI20N0e-BaJ0",
            authDomain: "realestate-d5629.firebaseapp.com",
            projectId: "realestate-d5629",
            storageBucket: "realestate-d5629.firebasestorage.app",
            messagingSenderId: "161382006957",
            appId: "1:161382006957:web:a3c175dc24e77e276a4624"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Register Function
        async function register() {
            const email = document.getElementById('email').value.trim();
            const password = document.getElementById('password').value.trim();
            const confirmPassword = document.getElementById('confirmPassword').value.trim();
            const message = document.getElementById('register-message');

            // Reset message every time before validation
            message.innerText = "";

            if (!email || !password || !confirmPassword) {
                message.innerText = "All fields are required!";
                return;
            }

            if (password !== confirmPassword) {
                message.innerText = "Passwords do not match!";
                return;
            }

            try {
                const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                const user = userCredential.user;

                // Save user details in Firestore
                await setDoc(doc(db, "users", user.uid), {
                    email: user.email,
                    createdAt: new Date().toISOString()
                });

                message.innerText = "Registration successful! Redirecting...";
                message.style.color = "green";
                setTimeout(() => {
                    window.location.href = "login.html"; // Redirect to login page
                }, 2000);
            } catch (error) {
                console.error("Error:", error);
                message.innerText = error.message;
            }
        }

        // Attach register function to window so it can be accessed in onclick
        window.register = register;
    </script>
</body>
</html>
